<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Problem Types - Make-It-All</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="css/plugins/plugins.min.css">
		<link rel="stylesheet" type="text/css" href="css/pages/problem_types.min.css">
		<link rel="stylesheet" href="fonts/font-awesome/css/font-awesome.min.css">
	</head>
	<body>
		<nav class="side-nav-bar">
			<a class="btn btn-info" href="index.html">
				Logout
				<i class="fa fa-sign-out"></i>
			</a>
			<div class="side-nav-bar-menu">
				<ul>
					<li>
						<a href="metrics.html">
							<i class="fa fa-line-chart fa-2x"></i>
							<p>Metrics</p>
						</a>
					</li>
					<li>
						<a href="tickets.html">
							<i class="fa fa-ticket fa-2x"></i>
							<p>Tickets</p>
						</a>
					</li>
					<li>
						<a href="software.html">
							<i class="fa fa-file-code-o fa-2x"></i>
							<p>Software</p>
						</a>
					</li>
					<li>
						<a href="hardware.html">
							<i class="fa fa-laptop fa-2x"></i>
							<p>Hardware</p>
						</a>
					</li>
					<li class="active">
						<a href="problem_types.html">
							<i class="fa fa-question fa-2x"></i>
							<p>Problem Types</p>
						</a>
					</li>
					<li>
						<a href="staff.html">
							<i class="fa fa-user-circle-o fa-2x"></i>
							<p>Staff</p>
						</a>
					</li>
	
					<li>
						<div class="breaker"></div>
						<a href="settings.html">
							<i class="fa fa-cog fa-2x"></i>
							<p>Settings</p>
						</a>
					</li>
				</ul>
			</div>
		</nav>

		<section id="list-view">
			<nav class="top-nav">
				<i class="fa fa-question"></i>
				<h4>Problem Types</h4>
				<div class="input-group search-field float-right">
					<span class="input-group-addon">
						<i class="fa fa-search"></i>
					</span>
					<input type="text" class="form-control" placeholder="Searchâ€¦">
				</div>
			</nav>
			
			<div class="splash-screen block-hidden">
				<h1>No problem types matched</h1>
			</div>
			
			<div class="problem-type-picker">
				<div class="type-columns"></div>
			</div>

			<div id="table-section">
				<table class="table">
					<thead>
						<tr>
							<th data-slug="id">ID</th>
							<th data-slug="name">NAME</th>
							<th data-slug="parent">PARENT</th>
							<th data-slug="eye"></th> <!-- If you want the eye when hovering over a table row, keep this -->
						</tr>
					</thead>
					<tbody></tbody>
				</table>
			</div>
		</section>
		
		<section id="single-view">
			<nav class="top-nav">
				<h4 class="main-content-title"></h4>
			</nav>

			<div class="splash-screen">
				<h1>No Selection</h1>
				<p>Get started, select a problem type to view its details.</p>
			</div>

			<div id="problem-type-view" class="block-hidden">
				<p class="problem-type-details">
					<strong>Problem Types:</strong>
				</p>
				<div class="table-container">
					<table class="table" id="problem-types-table">
						<thead>
							<tr>
								<th>ID</th>
								<th>NAME</th>
								<th>PARENT</th>
								<th></th>
							</tr>
						</thead>
						<tbody></tbody>
					</table>
				</div>
	
				<p class="problem-type-details">
					<strong>Specialists with this speciality:</strong>
				</p>
				<p id="no-specialists-data">There's no specialists that specialise in this problem!</p>
				<div class="table-container">
					<table class="table" id="specialists-table">
						<thead>
							<tr>
								<th>ID</th>
								<th>NAME</th>
								<th>JOB</th>
								<th>PHONE #</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>0</td>
								<td>Toby Mellor</td>
								<td>Developer</td>
								<td>1234567890</td>
								<td>
									<i class="fa fa-eye"></i>
								</td>
							</tr>
						</tbody>
					</table>
				</div>

				<p class="problem-type-details">
					<strong>Related Tickets:</strong>
				</p>
				<p id="no-tickets-data">There's no tickets related to this problem!</p>
				<div class="table-container">
					<table class="table" id="tickets-table">
						<thead>
							<tr>
								<th>ID</th>
								<th>TICKET TITLE</th>
								<th>STATUS</th>
								<th>CREATED</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>0</td>
								<td>Test Ticket Name!</td>
								<td>New</td>
								<td>Just now</td>
								<td>
									<i class="fa fa-eye"></i>
								</td>
							</tr>
							<tr>
								<td>1</td>
								<td>Something else...</td>
								<td>Resolved</td>
								<td>Just now</td>
								<td>
									<i class="fa fa-eye"></i>
								</td>
							</tr>
							<tr>
								<td>2</td>
								<td>Ticket name here</td>
								<td>Resolved</td>
								<td>Just now</td>
								<td>
									<i class="fa fa-eye"></i>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</section>

		<script src="js/plugins/plugins.min.js"></script>
		<script src="js/main.min.js"></script>
		<script src="js/pages/tickets.min.js"></script>
		<script src="js/pages/staff.min.js"></script>
		<script src="js/pages/problem_types.min.js"></script>
		<script>
			/**
			 * makeItAll is global, and contains "managers".
			 * Managers hold the data, e.g. a ticket.
			 *
			 * Define a new instance of MakeItAll, then set
			 * any managers that you'll use on your page.
			 *
			 * If you use a manager, make sure you include the relevant
			 * JS files after main. e.g. tickets.min.js for TicketManager
			 */
			var makeItAll = new MakeItAll;

			// TicketManager(filters, tickets, events)
			makeItAll.ticketManager = new TicketManager(
				[
					{
						id: 0,
						date_of_call: '21/04/2017 12:32',
						caller: 0,
						tickets: [0, 1]
					},
					{
						id: 1,
						date_of_call: '21/04/2017 12:32',
						caller: 0,
						tickets: [2]
					},
					{
						id: 2,
						date_of_call: '21/04/2017 12:32',
						caller: 0,
						tickets: [3]
					},
					{
						id: 3,
						date_of_call: '21/04/2017 12:32',
						caller: 0,
						tickets: [4]
					},
					{
						id: 4,
						date_of_call: '21/04/2017 12:32',
						caller: 0,
						tickets: [4]
					},
				],
				[
					{
						id: 0,
						slug: 'new',
						name: 'New',
						tickets: [0, 1, 2]
					},
					{
						id: 1,
						slug: 'pending_awaiting_staff',
						name: 'Pending - Awaiting Staff',
						tickets: []
					},
					{
						id: 2,
						slug: 'pending_in_progress',
						name: 'Pending - In Progress',
						tickets: [3]
					},
					{
						id: 3,
						slug: 'resolved',
						name: 'Resolved',
						tickets: [4]
					}
				],
				[
					{
						id: 0,
						calls: [0],
						filter: 'new',
						title: 'Printer Queue not working',
						description: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec dictum metus dui. Vivamus laoreet et nulla sed lobortis. Cras varius posuere feugiat. Nunc ultricies eros a lorem viverra semper.',
						assigned_to: 0,
						devices: [],
						created_at: 'Yesterday',
						updated_at: '1 hour ago',
						events: [0, 1, 2],
						problem_type: 5
					},
					{
						id: 1,
						calls: [0],
						filter: 'new',
						title: 'Coffee machine needs refilling',
						description: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec dictum metus dui. Vivamus laoreet et nulla sed lobortis. Cras varius posuere feugiat. Nunc ultricies eros a lorem viverra semper.',
						assigned_to: 1,
						devices: [],
						created_at: '4 days ago',
						updated_at: '4 days ago',
						events: [3],
						problem_type: 1
					},
					{
						id: 2,
						calls: [1],
						filter: 'new',
						title: 'Squeeky chair',
						description: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec dictum metus dui. Vivamus laoreet et nulla sed lobortis. Cras varius posuere feugiat. Nunc ultricies eros a lorem viverra semper.',
						assigned_to: 0,
						devices: [],
						created_at: '1 day ago',
						updated_at: 'Just now',
						events: [],
						problem_type: 3
					},
					{
						id: 3,
						calls: [2],
						filter: 'pending_in_progress',
						title: 'Spilt water on macbook',
						description: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec dictum metus dui. Vivamus laoreet et nulla sed lobortis. Cras varius posuere feugiat. Nunc ultricies eros a lorem viverra semper.',
						assigned_to: 1,
						devices: [],
						created_at: '23 hours ago',
						updated_at: '3 minutes ago',
						events: [],
						problem_type: 5
					},
					{
						id: 4,
						calls: [3, 4],
						filter: 'resolved',
						title: 'Computer wont turn on',
						description: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec dictum metus dui. Vivamus laoreet et nulla sed lobortis. Cras varius posuere feugiat. Nunc ultricies eros a lorem viverra semper.',
						assigned_to: 0,
						devices: [],
						created_at: '4 hours ago',
						updated_at: '4 hours ago',
						events: [],
						problem_type: 4
					}
				],
				[	
					{
						id: 0,
						ticket_id: 0,
						author: 0,
						type: 'comment',
						content: 'Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis in faucibus.',
						created_at: '1 hour ago'
					},
					{
						id: 1,
						ticket_id: 0,
						author: 0,
						type: 'event',
						content: 'Pending - Awaiting Review',
						created_at: '1 hour ago'
					},
					{
						id: 2,
						ticket_id: 0,
						author: 1,
						type: 'comment',
						content: 'Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis in faucibus.',
						created_at: 'Just now'
					},
					{
						id: 3,
						ticket_id: 1,
						author: 0,
						type: 'comment',
						content: 'Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis in faucibus.',
						created_at: '1 hour ago'
					}
				]
			);

			// StaffManager(staffMembers)
			makeItAll.staffManager = new StaffManager(null); // TODO: Pass in some fake data

			// ProblemTypeManager(problemTypes)
			makeItAll.problemTypeManager = new ProblemTypeManager(null);
		</script>
		<script type="text/javascript">
			var problemTypePage = new ProblemTypePage(true, true);

			problemTypePage.loadSubProblemTypes($('.type-columns'));

			$(document).on('click', '.type-column li', function() {
				problemTypePage.loadSubProblemTypes($('.type-columns'), $(this), parseInt($(this).data('problemTypeId')));
			});

			$(document).on('click', '#problem-types-table tbody tr:not(.highlight), #table-section tbody tr:not(.highlight)', function() {
				problemTypePage.loadProblemType($('.type-columns'), parseInt($(this).data('rowid')));
			});

			$(document).on('click', '#table-section tbody tr:not(.highlight)', function() {
				$('.search-field input').val('').keyup();
			});

			$(document).on('click', '.create-problem-type', function() {
				var $parentProblemType  = $(this).closest('.type-column').prev().find('.active'),
					parentProblemTypeId = parseInt($parentProblemType.data('problemTypeId'));

				if ($parentProblemType.length === 0) {
					parentProblemTypeId = null;
				}

				problemTypePage.createProblemType($(this).parent().siblings('input').val(), parentProblemTypeId);
			});

			$('.search-field input').on('keyup', function() {
				var query = $(this).val();

				problemTypePage.search(query);
			});
		</script>
	</body>
</html>